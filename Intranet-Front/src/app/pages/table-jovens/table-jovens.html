<div class="layout d-flex flex-column vh-90">
  <div class="table-container flex-grow-1 overflow-auto p-3">
    <table class="table table-hover tabela-registros">
      <caption class="text-center fw-bold">Lista de Jovens</caption>
      <thead class="table-dark">
        <tr>
          <th style="width: 40px;"></th>
          <th style="width: 200px;" class="text-center">Nome</th>
          <th style="width: 120px;" class="text-center">Matrícula</th>
          <th style="width: 120px;" class="text-center">Contratação</th>
          <th style="width: 120px;" class="text-center">Rescisão</th>
          <th style="width: 180px;" class="text-center">Empresa</th>
          <th style="width: 100px;" class="text-center">Período</th>
          <th style="width: 240px;" class="text-center">Ações</th>
        </tr>
      </thead>
      <tbody>
        <ng-container *ngFor="let jovem of jovens; let i = index">
          <tr (click)="toggleDetalhes(i)" class="align-middle">
            <td class="status-cell">
              <div [ngClass]="getStatusClass(jovem)"></div>
            </td>
            <td class="text-center">{{ jovem.nome }}</td>
            <td class="text-center">{{ jovem.matricula }}</td>
            <td class="text-center">{{ jovem.contratacao | date:'dd/MM/yyyy' }}</td>
            <td class="text-center">{{ jovem.rescisao | date:'dd/MM/yyyy' }}</td>
            <td class="text-center">{{ jovem.empresa?.nomeEmpresa || 'Não informado' }}</td>
            <td class="text-center">{{ jovem.periodoAvaliacao }} meses</td>
            <td class="d-flex justify-content-center gap-2">
              <button class="btn btn-primary btn-sm" (click)="$event.stopPropagation(); confirmar(jovem)">Enviar</button>
              <button class="btn btn-info btn-sm" (click)="$event.stopPropagation(); verAvaliacoes()">Avaliações</button>
              <button class="btn btn-warning btn-sm" (click)="$event.stopPropagation(); editarRegistro(jovem)">Editar</button>
              <button class="btn btn-danger btn-sm" (click)="$event.stopPropagation(); excluir(jovem.matricula)">Excluir</button>
            </td>
          </tr>

          <!-- informações adicionais -->
          <tr *ngIf="registroExpandido === i">
            <td colspan="8" class="p-0">
              <div class="bg-light border rounded d-flex flex-wrap justify-content-center gap-4 p-4">
                <div class="flex-fill min-w-200 text-center">
                  <strong>Telefone do Jovem:</strong><br>{{ jovem.telefone || 'Não informado' }}
                </div>
                <div class="flex-fill min-w-200 text-center">
                  <strong>Email do Jovem:</strong><br>{{ jovem.email || 'Não informado' }}
                </div>
                <div class="flex-fill min-w-200 text-center">
                  <strong>Nome do Responsável:</strong><br>{{ jovem.nomeresponsavel || 'Não informado' }}
                </div>
                <div class="flex-fill min-w-200 text-center">
                  <strong>Telefone do Responsável:</strong><br>{{ jovem.telefoneresponsavel || 'Não informado' }}
                </div>
                <div class="flex-fill min-w-200 text-center">
                  <strong>Observações:</strong><br>{{ jovem.observacoes || 'Não informado' }}
                </div>
              </div>
            </td>
          </tr>
        </ng-container>
        <tr *ngIf="jovens.length === 0">
          <td colspan="8" class="text-center">Nenhum jovem cadastrado.</td>
        </tr>
      </tbody>
    </table>
  </div>
</div>

<!-- Modal -->
<div *ngIf="registroEditando" class="modal-backdrop" (click)="fecharModal()">
  <div class="modal-dialog-custom" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h5 class="modal-title"><strong>Editar Registro - Jovem</strong></h5>
    </div>

    <div class="modal-body">
      <form>
        <div class="mb-3">
          <label for="nome" class="form-label">Nome</label>
          <input id="nome" type="text" class="form-control" [(ngModel)]="registroEditando.nome" name="nome">
        </div>
        <div class="mb-3">
          <label for="matricula" class="form-label">Matrícula</label>
          <input id="matricula" type="text" class="form-control" [(ngModel)]="registroEditando.matricula" name="matricula">
        </div>
        <div class="mb-3">
          <label for="contratacao" class="form-label">Data de Contratação</label>
          <input id="contratacao" type="date" class="form-control" [(ngModel)]="registroEditando.contratacao" name="contratacao">
        </div>
        <div class="mb-3">
          <label for="rescisao" class="form-label">Data de Rescisão</label>
          <input id="rescisao" type="date" class="form-control" [(ngModel)]="registroEditando.rescisao" name="rescisao">
        </div>
        <div class="mb-3">
          <label for="periodoAvaliacao" class="form-label">Período de Avaliação</label>
          <input id="periodoAvaliacao" type="number" class="form-control" [(ngModel)]="registroEditando.periodoAvaliacao" name="periodoAvaliacao">
        </div>
        <div class="mb-3">
          <label for="nomeresponsavel" class="form-label">Nome do Responsável</label>
          <input id="nomeresponsavel" type="text" class="form-control" [(ngModel)]="registroEditando.nomeresponsavel" name="nomeresponsavel">
        </div>
        <div class="mb-3">
          <label for="telefoneresponsavel" class="form-label">Telefone do Responsável</label>
          <input id="telefoneresponsavel" type="text" class="form-control" [(ngModel)]="registroEditando.telefoneresponsavel" name="telefoneresponsavel">
        </div>
        <div class="mb-3">
          <label for="observacoes" class="form-label">Observações</label>
          <textarea id="observacoes" class="form-control" [(ngModel)]="registroEditando.observacoes" name="observacoes"></textarea>
        </div>
      </form>
    </div>
    <div class="modal-footer">
      <button type="button" class="btn btn-primary" (click)="salvarEdicao()">Salvar</button>
      <button type="button" class="btn btn-secondary" (click)="fecharModal()">Cancelar</button>
    </div>
  </div>
</div>
