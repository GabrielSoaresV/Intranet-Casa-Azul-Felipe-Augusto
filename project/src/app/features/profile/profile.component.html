<div class="profile-container">
  <div class="profile-card">
    <h2>Meu Perfil</h2>

    <div class="alert" *ngIf="message" [class.alert-success]="messageType === 'success'" [class.alert-error]="messageType === 'error'">
      {{ message }}
    </div>

    <div *ngIf="loading" class="loading">Carregando...</div>

    <form [formGroup]="profileForm" (ngSubmit)="onSubmit()" *ngIf="!loading && currentProfile">
      <div class="profile-info">
        <div class="info-item">
          <strong>CPF:</strong> {{ currentProfile.cpf }}
        </div>
        <div class="info-item">
          <strong>Perfil:</strong>
          <span class="badge" [class]="'badge-' + currentProfile.role.toLowerCase()">
            {{ currentProfile.role }}
          </span>
        </div>
      </div>

      <div class="form-group">
        <label for="name">Nome</label>
        <input id="name" type="text" formControlName="name" />
        <div class="error-message" *ngIf="profileForm.get('name')?.invalid && profileForm.get('name')?.touched">
          Nome é obrigatório
        </div>
      </div>

      <div class="form-group">
        <label for="email">Email</label>
        <input id="email" type="email" formControlName="email" />
        <div class="error-message" *ngIf="profileForm.get('email')?.invalid && profileForm.get('email')?.touched">
          Email inválido
        </div>
      </div>

      <div class="form-group">
        <label for="phone">Telefone</label>
        <input id="phone" type="text" formControlName="phone" />
      </div>

      <div class="form-group">
        <label for="password">Nova Senha (deixe em branco para não alterar)</label>
        <input id="password" type="password" formControlName="password" />
        <div class="error-message" *ngIf="profileForm.get('password')?.invalid && profileForm.get('password')?.touched">
          Senha deve ter no mínimo 6 caracteres
        </div>
      </div>

      <button type="submit" class="btn-primary" [disabled]="saving || profileForm.invalid">
        {{ saving ? 'Salvando...' : 'Salvar Alterações' }}
      </button>
    </form>
  </div>

  <div class="admin-panel" *ngIf="showAdminPanel">
    <h2>Painel Administrativo</h2>
    <div class="profiles-list">
      <h3>Todos os Usuários</h3>
      <div class="profile-item" *ngFor="let profile of allProfiles">
        <div class="profile-item-info">
          <strong>{{ profile.name }}</strong>
          <span>{{ profile.cpf }}</span>
          <span class="badge" [class]="'badge-' + profile.role.toLowerCase()">{{ profile.role }}</span>
        </div>
        <button class="btn-delete" (click)="deleteProfile(profile.cpf)" *ngIf="profile.cpf !== currentProfile?.cpf">
          Deletar
        </button>
      </div>
    </div>
  </div>
</div>
